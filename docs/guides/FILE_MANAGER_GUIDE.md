# 文件管理页使用指南

本文档描述 CloudChan 文件管理页（`/cloudchan/index.html`）的交互与能力，面向日常使用与运维排查。

## 页面结构

- 顶部工具栏：上传主按钮、视图切换（列表/网格）、新建文件夹、刷新
- 左侧：树状文件夹（支持嵌套）
- 右侧：文件展示区（支持拖拽上传与批量操作）

## 上传

### 上传入口

- 工具栏“上传”按钮：选择一个或多个文件
- 右侧文件区拖拽上传：直接把文件拖到右侧内容区

### 自动上传

选择文件后会自动开始上传，不需要再点击“开始上传”。上传进度会在页面内显示，并在完成后自动刷新文件列表。

### 上传目标目录

上传会写入当前选中的文件夹（左侧树高亮项）。未选择文件夹时写入默认目录。

## 文件展示与视图

### 列表视图

- 表格展示：文件名、大小、日期、操作
- 文件名显示策略：
  - 默认两行展示，尽量显示完整文件名
  - 点击文件名单元格可展开/收起，便于在窄屏下查看长文件名

### 网格视图

- 卡片网格展示：文件名（含校验标识）、大小、日期
- 操作入口更简洁：卡片右下角“更多(…)”菜单提供常用操作

## 文件操作

### 下载

点击“下载”后会弹出通道选择，系统会基于网关健康/测速信息提供下载建议。

### 添加自定义下载网关

在“选择下载通道”弹窗中点击“添加”，填写名称与网关地址即可把你自己的网关加入列表。网关会保存在浏览器本地，下次打开仍然可用。

建议填写的地址为 IPFS 网关 base（通常以 `/ipfs/` 结尾），例如：

- `https://example.com/ipfs/`

### 重命名（支持后缀隐藏/显示）

重命名弹窗默认只编辑“文件名主体”，避免误改后缀导致文件类型变化。

- 默认：仅改主体，后缀保持不变
- 勾选“编辑后缀”：显示后缀输入框，可修改/移除/为无后缀文件添加后缀

### 移动

支持将文件移动到指定文件夹（单个或批量）。

### 删除

删除的是“元数据记录”，并不会从 IPFS 网络中物理删除内容（CID 仍可被访问）。

## 批量操作

右侧文件区顶部提供批量操作条：

- 全选 / 取消
- 批量移动
- 批量删除

## 分页与性能

- 支持分页展示
- 支持滚动懒加载（在大量文件下减少一次性渲染压力）

## 常见问题

### 为什么文件名显示不全？

窄屏下文件名会按两行展示。点击文件名单元格可展开/收起查看完整文件名。

### 为什么重命名时看不到后缀？

默认隐藏后缀编辑以防误改。勾选“编辑后缀”即可显示并编辑后缀。

